function FrontBase(){}function Auth(){this.maskWrapper=$(".mask-wrapper"),this.smsCapacha=$(".sms-captcha-btn")}FrontBase.prototype.listenAuthBoxHover=function(){var e=$(".auth-box"),t=$(".user-more-box");e.hover(function(){t.show()},function(){t.hide()})},FrontBase.prototype.run=function(){self=this,self.listenAuthBoxHover()},$(function(){(new FrontBase).run()}),Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.switchWrapper=function(){$(".switch").click(function(){var e=$(".scroll-wrapper"),t=e.css("left");(t=parseInt(t))<0?e.animate({left:"0"}):e.animate({left:"-400px"})})},Auth.prototype.listenShowHideEvent=function(){var e=this;console.log("hello");var t=$(".sigin-in"),n=$(".sigin-up"),s=$(".close-btn"),a=$(".scroll-wrapper");t.click(function(){e.showEvent(),a.css({left:0})}),n.click(function(){e.showEvent(),a.css({left:-400})}),s.click(function(){e.hideEvent()})},Auth.prototype.listenSigninEvent=function(){var s=this,e=$(".signin-group"),a=e.find("input[name='telephone']"),o=e.find("input[name='password']"),i=e.find("input[name='remember']");e.find(".submit-btn").click(function(){var e=a.val(),t=o.val(),n=i.prop("checked")?1:0;xfzajax.post({url:"/auth/login/",data:{telephone:e,password:t,remember:n},success:function(e){if(200==e.code)console.log(e),s.hideEvent(),window.location.reload();else{var t=e.message;if("string"==typeof t||t.constructor==String)window.messageBox.show(t);else for(key in t){var n=t[key][0].message;window.messageBox.show(n)}}},failed:function(e){console.log(e)}})})},Auth.prototype.listenImgCapacha=function(){imgCapacha=$(".img-captcha"),imgCapacha.click(function(){imgCapacha.attr("src","/auth/img_captcha?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){self=this,messageBox.showInfo("验证码已发送"),self.smsCapacha.addClass("disabled");var e=5;self.smsCapacha.unbind("click");var t=setInterval(function(){self.smsCapacha.text(e+"s"),--e<=0&&(clearInterval(t),self.smsCapacha.text("发送验证码"),self.smsCapacha.removeClass("disabled"),self.listenSmsEvent())},1e3)},Auth.prototype.listenSmsEvent=function(){self=this;var t=$(".signup-group").find('input[name="telephone"]');console.log(t),self.smsCapacha.click(function(){console.log("sms");var e=t.val();console.log(t),console.log(e),e?xfzajax.get({url:"/auth/send_message/",data:{telephone:e},success:function(e){console.log(e),200===e.code&&self.smsSuccessEvent()}}):messageBox.showError("请输入手机号码")})},Auth.prototype.listenRegister=function(){var e=$(".signup-group"),i=e.find("input[name='telephone']"),c=e.find("input[name='username']"),r=e.find("input[name='img_captcha']"),l=e.find("input[name='password1']"),p=e.find("input[name='password2']"),u=e.find("input[name='sms_captcha']");e.find(".submit-btn").click(function(){var e=i.val(),t=l.val(),n=p.val(),s=c.val(),a=r.val(),o=u.val();xfzajax.post({url:"/auth/register/",data:{telephone:e,password1:t,password2:n,username:s,img_captcha:a,sms_captcha:o},success:function(){console.log(result),self.hideEvent(),window.location.reload()}})})},Auth.prototype.run=function(){var e=this;e.listenShowHideEvent(),e.switchWrapper(),e.listenSigninEvent(),e.listenImgCapacha(),e.listenSmsEvent(),e.listenRegister()},$(function(){(new Auth).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(e){var t=new Date(e),n=t.getTime(),s=((new Date).getTime()-n)/1e3;return s<60?"刚刚":60<=s&&s<3600?(minutes=parseInt(s/60),minutes+"分钟前"):3600<=s&&s<86400?(hours=parseInt(s/60/60),hours+"小时前"):86400<=s&&s<2592e3?(days=parseInt(s/60/60/24),days+"天前"):t.getFullYear()+"/"+t.getMonth()+"/"+t.getDay()+" "+t.getHours()+":"+t.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb21fYmFzZS5qcyJdLCJuYW1lcyI6WyJGcm9udEJhc2UiLCJBdXRoIiwidGhpcyIsIm1hc2tXcmFwcGVyIiwiJCIsInNtc0NhcGFjaGEiLCJwcm90b3R5cGUiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwicnVuIiwic2VsZiIsInNob3dFdmVudCIsImhpZGVFdmVudCIsInN3aXRjaFdyYXBwZXIiLCJjbGljayIsInNjcm9sbFdyYXBwZXIiLCJjdXJyZW50TGVmdCIsImNzcyIsInBhcnNlSW50IiwiYW5pbWF0ZSIsImxlZnQiLCJsaXN0ZW5TaG93SGlkZUV2ZW50IiwiY29uc29sZSIsImxvZyIsInNpZ2luQnRuIiwic2lndXBCdG4iLCJjbG9zZUJ0biIsImxpc3RlblNpZ25pbkV2ZW50Iiwic2lnbmluR3JvdXAiLCJ0ZWxlcGhvbmVJbnB1dCIsImZpbmQiLCJwYXNzd29yZElucHV0IiwicmVtZW1iZXJJbnB1dCIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwieGZ6YWpheCIsInBvc3QiLCJ1cmwiLCJkYXRhIiwic3VjY2VzcyIsInJlc3VsdCIsImNvZGUiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsIm1lc3NhZ2VvYmoiLCJtZXNzYWdlIiwiY29uc3RydWN0b3IiLCJTdHJpbmciLCJtZXNzYWdlQm94Iiwia2V5IiwiZmFpbGVkIiwibGlzdGVuSW1nQ2FwYWNoYSIsImltZ0NhcGFjaGEiLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsInNtc1N1Y2Nlc3NFdmVudCIsInNob3dJbmZvIiwiYWRkQ2xhc3MiLCJjb3VudCIsInVuYmluZCIsInRpbWVyIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwibGlzdGVuU21zRXZlbnQiLCJnZXQiLCJzaG93RXJyb3IiLCJsaXN0ZW5SZWdpc3RlciIsInNpbnVwR3JvdXAiLCJ1c2VybmFtZUlucHV0IiwiaW1nY2FwdGNoYUlucHV0IiwicGFzc3dvcmQxSW5wdXQiLCJwYXNzd29yZDJJbnB1dCIsInNtc2NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsInVzZXJuYW1lIiwiaW1nY2hhcHRoYSIsInNtc2NoYXB0aGEiLCJpbWdfY2FwdGNoYSIsInNtc19jYXB0Y2hhIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lc3RhbXAiLCJtaW51dGVzIiwiaG91cnMiLCJkYXlzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsYUF3QlQsU0FBU0MsT0FDTUMsS0FDTkMsWUFBY0MsRUFBRSxpQkFEVkYsS0FFTkcsV0FBYUQsRUFBRSxvQkF2QnhCSixVQUFVTSxVQUFVQyxtQkFBcUIsV0FDckMsSUFBSUMsRUFBVUosRUFBRSxhQUNaSyxFQUFhTCxFQUFFLGtCQUNuQkksRUFBUUUsTUFBTSxXQUNWRCxFQUFZRSxRQUNkLFdBQ0VGLEVBQVlHLFVBR3BCWixVQUFVTSxVQUFVTyxJQUFNLFdBQ3RCQyxLQUFPWixLQUNQWSxLQUFLUCxzQkFHVEgsRUFBRSxZQUNrQixJQUFJSixXQUNWYSxRQVNkWixLQUFLSyxVQUFVUyxVQUFZLFdBQ1hiLEtBQ1BDLFlBQVlRLFFBRXJCVixLQUFLSyxVQUFVVSxVQUFZLFdBQ1pkLEtBQ05DLFlBQVlTLFFBRXJCWCxLQUFLSyxVQUFVVyxjQUFnQixXQUMzQmIsRUFBRSxXQUFXYyxNQUFNLFdBQ2YsSUFBSUMsRUFBZ0JmLEVBQUUsbUJBQ2xCZ0IsRUFBY0QsRUFBY0UsSUFBSSxTQUNwQ0QsRUFBY0UsU0FBU0YsSUFDTixFQUNiRCxFQUFjSSxRQUFRLENBQUNDLEtBQU8sTUFFOUJMLEVBQWNJLFFBQVEs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QkEsRUFBWSxRQUN6Q0csS0FBT2pGLFNBQVM4RSxFQUFZLEdBQUssR0FBSyxJQUMvQkcsS0FBTyxNQUVIUCxFQUFLUSxjQUtKLElBSkFSLEVBQUtTLFdBSUssSUFIWlQsRUFBS1UsU0FHZSxJQUZuQlYsRUFBS1csV0FFdUIsSUFEMUJYLEVBQUtZIiwiZmlsZSI6ImZyb21fYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBGcm9udEJhc2UoKSB7XHJcblxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoQm94ID0gJCgnLmF1dGgtYm94Jyk7XHJcbiAgICB2YXIgdXNlck1vcmVCb3g9ICQoJy51c2VyLW1vcmUtYm94JylcclxuICAgIGF1dGhCb3guaG92ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKVxyXG4gICAgfSxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdXNlck1vcmVCb3guaGlkZSgpXHJcbiAgICB9KVxyXG59XHJcbkZyb250QmFzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc2VsZiA9IHRoaXNcclxuICAgIHNlbGYubGlzdGVuQXV0aEJveEhvdmVyKClcclxufVxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZnJvbnRiYXNlID0gbmV3IEZyb250QmFzZSgpO1xyXG4gICAgZnJvbnRiYXNlLnJ1bigpXHJcbn0pXHJcblxyXG5cclxuZnVuY3Rpb24gQXV0aCgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoJy5tYXNrLXdyYXBwZXInKVxyXG4gICAgc2VsZi5zbXNDYXBhY2hhID0gJCgnLnNtcy1jYXB0Y2hhLWJ0bicpO1xyXG59O1xyXG5BdXRoLnByb3RvdHlwZS5zaG93RXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyICBzZWxmID0gdGhpc1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5zaG93KClcclxufVxyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzXHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKVxyXG59XHJcbkF1dGgucHJvdG90eXBlLnN3aXRjaFdyYXBwZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAkKFwiLnN3aXRjaFwiKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNjcm9sbFdyYXBwZXIgPSAkKFwiLnNjcm9sbC13cmFwcGVyXCIpO1xyXG4gICAgICAgIHZhciBjdXJyZW50TGVmdCA9IHNjcm9sbFdyYXBwZXIuY3NzKFwibGVmdFwiKTtcclxuICAgICAgICBjdXJyZW50TGVmdCA9IHBhcnNlSW50KGN1cnJlbnRMZWZ0KTtcclxuICAgICAgICBpZihjdXJyZW50TGVmdCA8IDApe1xyXG4gICAgICAgICAgICBzY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOicwJ30pO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzY3JvbGxXcmFwcGVyLmFuaW1hdGUoe1wibGVmdFwiOlwiLTQwMHB4XCJ9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93SGlkZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzXHJcbiAgICBjb25zb2xlLmxvZyhcImhlbGxvXCIpO1xyXG4gICAgdmFyIHNpZ2luQnRuID0gJCgnLnNpZ2luLWluJyk7XHJcbiAgICB2YXIgc2lndXBCdG4gPSAkKCcuc2lnaW4tdXAnKTtcclxuICAgIHZhciBjbG9zZUJ0biA9ICQoJy5jbG9zZS1idG4nKTtcclxuICAgIHZhciBzY3JvbGxXcmFwcGVyID0gJCgnLnNjcm9sbC13cmFwcGVyJylcclxuXHJcbiAgICBzaWdpbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKVxyXG4gICAgICAgIHNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjowfSlcclxuICAgIH0pXHJcbiAgICBzaWd1cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKVxyXG4gICAgICAgIHNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjotNDAwfSlcclxuICAgIH0pXHJcbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5oaWRlRXZlbnQoKVxyXG5cclxuICAgIH0pXHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25pbkV2ZW50ID0gZnVuY3Rpb24gKCl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXNcclxuICAgIHZhciBzaWduaW5Hcm91cCA9ICQoJy5zaWduaW4tZ3JvdXAnKVxyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzaWduaW5Hcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcclxuICAgIHZhciByZW1lbWJlcklucHV0ID0gc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbmluR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKClcclxuICAgICAgICB2YXIgcGFzc3dvcmQgPSBwYXNzd29yZElucHV0LnZhbCgpXHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKT8xOjBcclxuICAgICAgICB4ZnphamF4LnBvc3Qoe3VybDonL2F1dGgvbG9naW4vJyxkYXRhOntcclxuICAgICAgICAgICAgJ3RlbGVwaG9uZSc6dGVsZXBob25lLFxyXG4gICAgICAgICAgICAgJ3Bhc3N3b3JkJzpwYXNzd29yZCxcclxuICAgICAgICAgICAgICdyZW1lbWJlcic6cmVtZW1iZXIsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZihyZXN1bHQuY29kZSA9PSAyMDApe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdClcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGVFdmVudCgpXHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXHJcbiAgICAgICAgICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VvYmogPSByZXN1bHQubWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZW9iaiA9PSBcInN0cmluZ1wiIHx8IG1lc3NhZ2VvYmouY29uc3RydWN0b3IgPT0gU3RyaW5nKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlb2JqKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGtleSBpbiBtZXNzYWdlb2JqKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlcyA9IG1lc3NhZ2VvYmpba2V5XVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VkaWN0ID0gbWVzc2FnZXNbMF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZWRpY3RbJ21lc3NhZ2UnXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWxlZCc6ZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgIH0pXHJcblxyXG59XHJcblxyXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5JbWdDYXBhY2hhID0gZnVuY3Rpb24gKCl7XHJcbiAgICAgICAgaW1nQ2FwYWNoYSA9ICQoJy5pbWctY2FwdGNoYScpO1xyXG4gICAgICAgIGltZ0NhcGFjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpbWdDYXBhY2hhLmF0dHIoJ3NyYycsJy9hdXRoL2ltZ19jYXB0Y2hhJysnP3JhbmRvbT0nK01hdGgucmFuZG9tKCkpXHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2Vzc0V2ZW50ID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgIHNlbGYgPSB0aGlzXHJcbiAgICAgICAgICAgICBtZXNzYWdlQm94LnNob3dJbmZvKFwi6aqM6K+B56CB5bey5Y+R6YCBXCIpXHJcbiAgICAgICAgICAgICBzZWxmLnNtc0NhcGFjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJylcclxuICAgICAgICAgICAgIHZhciBjb3VudCA9IDVcclxuICAgICAgICAgICAgIHNlbGYuc21zQ2FwYWNoYS51bmJpbmQoJ2NsaWNrJylcclxuICAgICAgICAgICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICBzZWxmLnNtc0NhcGFjaGEudGV4dChjb3VudCsncycpO1xyXG4gICAgICAgICAgICAgICAgIGNvdW50LS07XHJcbiAgICAgICAgICAgICAgICAgaWYgKGNvdW50IDw9MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc0NhcGFjaGEudGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNtc0NhcGFjaGEucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RlblNtc0V2ZW50KClcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICB9LDEwMDApXHJcbn1cclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNtc0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc2VsZiA9IHRoaXNcclxuICAgIHZhciBzaWd1cEdyb3VwID0gJCgnLnNpZ251cC1ncm91cCcpXHJcbiAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWd1cEdyb3VwLmZpbmQoJ2lucHV0W25hbWU9XCJ0ZWxlcGhvbmVcIl0nKVxyXG4gICAgY29uc29sZS5sb2codGVsZXBob25lSW5wdXQpXHJcbiAgICBzZWxmLnNtc0NhcGFjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzbXMnKVxyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRlbGVwaG9uZUlucHV0KVxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRlbGVwaG9uZSlcclxuICAgICAgICBpZiAodGVsZXBob25lKXtcclxuICAgICAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAgICAgJ3VybCc6Jy9hdXRoL3NlbmRfbWVzc2FnZS8nLFxyXG4gICAgICAgICAgICAgICAgJ2RhdGEnOntcclxuICAgICAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdClcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIHJlc3VsdFsnY29kZSddID09PSAyMDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2Vzc0V2ZW50KClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93RXJyb3IoXCLor7fovpPlhaXmiYvmnLrlj7fnoIFcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgfSlcclxufVxyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuUmVnaXN0ZXIgPSBmdW5jdGlvbigpe1xyXG4gICAgdmFyIHNpbnVwR3JvdXAgPSAkKCcuc2lnbnVwLWdyb3VwJylcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpXHJcbiAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIilcclxuICAgIHZhciBpbWdjYXB0Y2hhSW5wdXQgPSBzaW51cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpXHJcbiAgICB2YXIgcGFzc3dvcmQxSW5wdXQgPSBzaW51cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKVxyXG4gICAgdmFyIHBhc3N3b3JkMklucHV0ID0gc2ludXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIilcclxuICAgIHZhciBzbXNjYXB0Y2hhSW5wdXQgPSBzaW51cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpXHJcbiAgICB2YXIgc3VibWl0QnRuID0gc2ludXBHcm91cC5maW5kKCcuc3VibWl0LWJ0bicpXHJcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKVxyXG4gICAgICAgIHZhciBwYXNzd29yZDEgPSBwYXNzd29yZDFJbnB1dC52YWwoKVxyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKVxyXG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKClcclxuICAgICAgICB2YXIgaW1nY2hhcHRoYSA9IGltZ2NhcHRjaGFJbnB1dC52YWwoKVxyXG4gICAgICAgIHZhciBzbXNjaGFwdGhhID0gc21zY2FwdGNoYUlucHV0LnZhbCgpXHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7dXJsOicvYXV0aC9yZWdpc3Rlci8nLGRhdGE6e1xyXG4gICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAncGFzc3dvcmQxJzpwYXNzd29yZDEsXHJcbiAgICAgICAgICAgICAncGFzc3dvcmQyJzpwYXNzd29yZDIsXHJcbiAgICAgICAgICAgICAgJ3VzZXJuYW1lJzp1c2VybmFtZSxcclxuICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdjaGFwdGhhLFxyXG4gICAgICAgICAgICAgICdzbXNfY2FwdGNoYScgOiBzbXNjaGFwdGhhXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KClcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgfSlcclxufVxyXG5cclxuXHJcbkF1dGgucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpc1xyXG4gICAgc2VsZi5saXN0ZW5TaG93SGlkZUV2ZW50KClcclxuICAgIHNlbGYuc3dpdGNoV3JhcHBlcigpXHJcbiAgICBzZWxmLmxpc3RlblNpZ25pbkV2ZW50KClcclxuICAgIHNlbGYubGlzdGVuSW1nQ2FwYWNoYSgpXHJcbiAgICBzZWxmLmxpc3RlblNtc0V2ZW50KClcclxuICAgIHNlbGYubGlzdGVuUmVnaXN0ZXIoKVxyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgICBhdXRoLnJ1bigpO1xyXG59KVxyXG5cclxuXHJcblxyXG5cclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgaWYod2luZG93LnRlbXBsYXRlKXtcclxuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xyXG4gICAgICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7IC8vIOW+l+WIsOeahOaYr+avq+enkueahFxyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOyAvL+W+l+WIsOeahOaYr+W9k+WJjeaXtumXtOeahOaXtumXtOaIs1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKS8xMDAwOyAvLyDpmaTku6UxMDAw77yM5b6X5Yiw55qE5piv56eSXHJcbiAgICAgICAgICAgIGlmKHRpbWVzdGFtcCA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAqNjApIHtcclxuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcysn5YiG6ZKf5YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCkge1xyXG4gICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBob3Vycysn5bCP5pe25YmNJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCozMCkge1xyXG4gICAgICAgICAgICAgICAgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyKycvJyttb250aCsnLycrZGF5K1wiIFwiK2hvdXIrXCI6XCIrbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuXHJcblxyXG5cclxuIl19
